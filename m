Return-Path: <iommu-bounces@lists.linux-foundation.org>
X-Original-To: lists.iommu@lfdr.de
Delivered-To: lists.iommu@lfdr.de
Received: from mail.linuxfoundation.org (mail.linuxfoundation.org [140.211.169.12])
	by mail.lfdr.de (Postfix) with ESMTPS id 14FADE7046
	for <lists.iommu@lfdr.de>; Mon, 28 Oct 2019 12:21:33 +0100 (CET)
Received: from mail.linux-foundation.org (localhost [127.0.0.1])
	by mail.linuxfoundation.org (Postfix) with ESMTP id DC78F10D2;
	Mon, 28 Oct 2019 11:21:02 +0000 (UTC)
X-Original-To: iommu@lists.linux-foundation.org
Delivered-To: iommu@mail.linuxfoundation.org
Received: from smtp1.linuxfoundation.org (smtp1.linux-foundation.org
	[172.17.192.35])
	by mail.linuxfoundation.org (Postfix) with ESMTPS id EBC3DB49
	for <iommu@lists.linux-foundation.org>;
	Mon, 28 Oct 2019 08:28:47 +0000 (UTC)
X-Greylist: domain auto-whitelisted by SQLgrey-1.7.6
Received: from mailgw01.mediatek.com (unknown [210.61.82.183])
	by smtp1.linuxfoundation.org (Postfix) with ESMTP id 95BC242D
	for <iommu@lists.linux-foundation.org>;
	Mon, 28 Oct 2019 08:28:46 +0000 (UTC)
X-UUID: 48424e0d26cd42b98a832beb67086cc4-20191028
X-UUID: 48424e0d26cd42b98a832beb67086cc4-20191028
Received: from mtkcas07.mediatek.inc [(172.21.101.84)] by mailgw01.mediatek.com
	(envelope-from <chao.hao@mediatek.com>)
	(Cellopoint E-mail Firewall v4.1.10 Build 0809 with TLS)
	with ESMTP id 2042998017; Mon, 28 Oct 2019 16:28:45 +0800
Received: from mtkcas08.mediatek.inc (172.21.101.126) by
	mtkmbs06n1.mediatek.inc (172.21.101.129) with Microsoft SMTP Server
	(TLS) id 15.0.1395.4; Mon, 28 Oct 2019 16:28:43 +0800
Received: from localhost.localdomain (10.15.20.246) by mtkcas08.mediatek.inc
	(172.21.101.73) with Microsoft SMTP Server id 15.0.1395.4 via Frontend
	Transport; Mon, 28 Oct 2019 16:28:40 +0800
From: Chao Hao <chao.hao@mediatek.com>
To: Joerg Roedel <joro@8bytes.org>, Rob Herring <robh+dt@kernel.org>, Matthias
	Brugger <matthias.bgg@gmail.com>
Subject: [PATCH 05/13] iommu/mediatek: Remove pgtable info in mtk_iommu_domain
Date: Mon, 28 Oct 2019 16:28:12 +0800
Message-ID: <20191028082820.20221-6-chao.hao@mediatek.com>
X-Mailer: git-send-email 2.18.0
In-Reply-To: <20191028082820.20221-1-chao.hao@mediatek.com>
References: <20191028082820.20221-1-chao.hao@mediatek.com>
MIME-Version: 1.0
X-Spam-Status: No, score=-0.2 required=5.0 tests=BAYES_00,HTML_MESSAGE,
	MAY_BE_FORGED, MIME_BASE64_TEXT,
	UNPARSEABLE_RELAY autolearn=ham version=3.3.1
X-Spam-Checker-Version: SpamAssassin 3.3.1 (2010-03-16) on
	smtp1.linux-foundation.org
X-Mailman-Approved-At: Mon, 28 Oct 2019 11:21:00 +0000
Cc: Anan Sun <anan.sun@mediatek.com>, devicetree@vger.kernel.org,
	Cui Zhang <cui.zhang@mediatek.com>,
	Jun Yan <jun.yan@mediatek.com>, wsd_upstream@mediatek.com,
	linux-kernel@vger.kernel.org, Chao Hao <chao.hao@mediatek.com>,
	iommu@lists.linux-foundation.org, linux-mediatek@lists.infradead.org,
	Miles Chen <miles.chen@mediatek.com>, linux-arm-kernel@lists.infradead.org,
	Guangming Cao <guangming.cao@mediatek.com>
X-BeenThere: iommu@lists.linux-foundation.org
X-Mailman-Version: 2.1.12
Precedence: list
List-Id: Development issues for Linux IOMMU support
	<iommu.lists.linux-foundation.org>
List-Unsubscribe: <https://lists.linuxfoundation.org/mailman/options/iommu>,
	<mailto:iommu-request@lists.linux-foundation.org?subject=unsubscribe>
List-Archive: <http://lists.linuxfoundation.org/pipermail/iommu/>
List-Post: <mailto:iommu@lists.linux-foundation.org>
List-Help: <mailto:iommu-request@lists.linux-foundation.org?subject=help>
List-Subscribe: <https://lists.linuxfoundation.org/mailman/listinfo/iommu>,
	<mailto:iommu-request@lists.linux-foundation.org?subject=subscribe>
Content-Type: multipart/mixed; boundary="===============2854122726277219096=="
Sender: iommu-bounces@lists.linux-foundation.org
Errors-To: iommu-bounces@lists.linux-foundation.org

--===============2854122726277219096==
Content-Type: multipart/alternative;
	boundary="__=_Part_Boundary_005_568621771.225270334"

--__=_Part_Boundary_005_568621771.225270334
Content-Type: text/html
Content-Transfer-Encoding: base64

PHByZT4NClRoaXMgcGF0Y2ggd2lsbCB1c2UgbXRrX2lvbW11X3BndGFibGUgdG8gcmVwbGFjZSB0
aGUgcGFydA0Kb2YgcGd0YWJsZSBpbiBtdGtfaW9tbXVfZG9tYWluLCBzbyB3ZSBjYW4gcmVtb3Zl
IHRoZSBpbmZvcm1hdGlvbg0Kb2YgcGd0YWJsZSBpbiBtdGtfaW9tbXVfZG9tYWluLg0KDQpTaWdu
ZWQtb2ZmLWJ5OiBDaGFvIEhhbyAmbHQ7Y2hhby5oYW9AbWVkaWF0ZWsuY29tJmd0Ow0KLS0tDQog
ZHJpdmVycy9pb21tdS9tdGtfaW9tbXUuYyB8IDM3ICsrKysrKysrKysrKysrKysrLS0tLS0tLS0t
LS0tLS0tLS0tLS0NCiAxIGZpbGUgY2hhbmdlZCwgMTcgaW5zZXJ0aW9ucygrKSwgMjAgZGVsZXRp
b25zKC0pDQoNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2lvbW11L210a19pb21tdS5jIGIvZHJpdmVy
cy9pb21tdS9tdGtfaW9tbXUuYw0KaW5kZXggM2ZhMDliMTJlOWY5Li5mMjY0ZmE4YzE2YTAgMTAw
NjQ0DQotLS0gYS9kcml2ZXJzL2lvbW11L210a19pb21tdS5jDQorKysgYi9kcml2ZXJzL2lvbW11
L210a19pb21tdS5jDQpAQCAtMTE3LDkgKzExNyw2IEBADQogI2RlZmluZSBNVEtfTTRVX1RPX1BP
UlQoaWQpCQkoKGlkKSAmYW1wOyAweDFmKQ0KIA0KIHN0cnVjdCBtdGtfaW9tbXVfZG9tYWluIHsN
Ci0Jc3RydWN0IGlvX3BndGFibGVfY2ZnCQljZmc7DQotCXN0cnVjdCBpb19wZ3RhYmxlX29wcwkJ
KmlvcDsNCi0NCiAJc3RydWN0IGlvbW11X2RvbWFpbgkJZG9tYWluOw0KIH07DQogDQpAQCAtMzc5
LDYgKzM3NiwxMCBAQCBzdGF0aWMgaW50IG10a19pb21tdV9hdHRhY2hfcGd0YWJsZShzdHJ1Y3Qg
bXRrX2lvbW11X2RhdGEgKmRhdGEsDQogCS8qIGJpbmRpbmcgdG8gcGd0YWJsZSAqLw0KIAlkYXRh
LSZndDtwZ3RhYmxlID0gcGd0YWJsZTsNCiANCisJLyogdXBkYXRlIEhXIHNldHRpbmdzICovDQor
CXdyaXRlbChwZ3RhYmxlLSZndDtjZmcuYXJtX3Y3c19jZmcudHRiclswXSAmYW1wOyBNTVVfUFRf
QUREUl9NQVNLLA0KKwkgICAgICAgZGF0YS0mZ3Q7YmFzZSArIFJFR19NTVVfUFRfQkFTRV9BRERS
KTsNCisNCiAJZGV2X2luZm8oZGF0YS0mZ3Q7ZGV2LCAmcXVvdDttNHUlZCBhdHRhY2hfcGd0YWJs
ZSBkb25lIVxuJnF1b3Q7LCBkYXRhLSZndDttNHVfaWQpOw0KIA0KIAlyZXR1cm4gMDsNCkBAIC00
MDQsOCArNDA1LDYgQEAgc3RhdGljIHN0cnVjdCBpb21tdV9kb21haW4gKm10a19pb21tdV9kb21h
aW5fYWxsb2ModW5zaWduZWQgdHlwZSkNCiAJaWYgKGlvbW11X2dldF9kbWFfY29va2llKCZhbXA7
ZG9tLSZndDtkb21haW4pKQ0KIAkJZ290byAgZnJlZV9kb207DQogDQotCWRvbS0mZ3Q7Y2ZnID0g
cGd0YWJsZS0mZ3Q7Y2ZnOw0KLQlkb20tJmd0O2lvcCA9IHBndGFibGUtJmd0O2lvcDsNCiAJLyog
VXBkYXRlIG91ciBzdXBwb3J0IHBhZ2Ugc2l6ZXMgYml0bWFwICovDQogCWRvbS0mZ3Q7ZG9tYWlu
LnBnc2l6ZV9iaXRtYXAgPSBwZ3RhYmxlLSZndDtjZmcucGdzaXplX2JpdG1hcDsNCiANCkBAIC00
MjIsMTEgKzQyMSwxMiBAQCBzdGF0aWMgc3RydWN0IGlvbW11X2RvbWFpbiAqbXRrX2lvbW11X2Rv
bWFpbl9hbGxvYyh1bnNpZ25lZCB0eXBlKQ0KIA0KIHN0YXRpYyB2b2lkIG10a19pb21tdV9kb21h
aW5fZnJlZShzdHJ1Y3QgaW9tbXVfZG9tYWluICpkb21haW4pDQogew0KLQlzdHJ1Y3QgbXRrX2lv
bW11X2RvbWFpbiAqZG9tID0gdG9fbXRrX2RvbWFpbihkb21haW4pOw0KKwlzdHJ1Y3QgbXRrX2lv
bW11X3BndGFibGUgKnBndGFibGUgPSBtdGtfaW9tbXVfZ2V0X3BndGFibGUoKTsNCiANCi0JZnJl
ZV9pb19wZ3RhYmxlX29wcyhkb20tJmd0O2lvcCk7DQogCWlvbW11X3B1dF9kbWFfY29va2llKGRv
bWFpbik7DQogCWtmcmVlKHRvX210a19kb21haW4oZG9tYWluKSk7DQorCWZyZWVfaW9fcGd0YWJs
ZV9vcHMocGd0YWJsZS0mZ3Q7aW9wKTsNCisJa2ZyZWUocGd0YWJsZSk7DQogfQ0KIA0KIHN0YXRp
YyBpbnQgbXRrX2lvbW11X2F0dGFjaF9kZXZpY2Uoc3RydWN0IGlvbW11X2RvbWFpbiAqZG9tYWlu
LA0KQEAgLTQzOSwxMSArNDM5LDggQEAgc3RhdGljIGludCBtdGtfaW9tbXVfYXR0YWNoX2Rldmlj
ZShzdHJ1Y3QgaW9tbXVfZG9tYWluICpkb21haW4sDQogCQlyZXR1cm4gLUVOT0RFVjsNCiANCiAJ
LyogVXBkYXRlIHRoZSBwZ3RhYmxlIGJhc2UgYWRkcmVzcyByZWdpc3RlciBvZiB0aGUgTTRVIEhX
ICovDQotCWlmICghZGF0YS0mZ3Q7bTR1X2RvbSkgew0KKwlpZiAoIWRhdGEtJmd0O200dV9kb20p
DQogCQlkYXRhLSZndDttNHVfZG9tID0gZG9tOw0KLQkJd3JpdGVsKGRvbS0mZ3Q7Y2ZnLmFybV92
N3NfY2ZnLnR0YnJbMF0gJmFtcDsgTU1VX1BUX0FERFJfTUFTSywNCi0JCSAgICAgICBkYXRhLSZn
dDtiYXNlICsgUkVHX01NVV9QVF9CQVNFX0FERFIpOw0KLQl9DQogDQogCW10a19pb21tdV9jb25m
aWcoZGF0YSwgZGV2LCB0cnVlKTsNCiAJcmV0dXJuIDA7DQpAQCAtNDYzLDcgKzQ2MCw3IEBAIHN0
YXRpYyB2b2lkIG10a19pb21tdV9kZXRhY2hfZGV2aWNlKHN0cnVjdCBpb21tdV9kb21haW4gKmRv
bWFpbiwNCiBzdGF0aWMgaW50IG10a19pb21tdV9tYXAoc3RydWN0IGlvbW11X2RvbWFpbiAqZG9t
YWluLCB1bnNpZ25lZCBsb25nIGlvdmEsDQogCQkJIHBoeXNfYWRkcl90IHBhZGRyLCBzaXplX3Qg
c2l6ZSwgaW50IHByb3QpDQogew0KLQlzdHJ1Y3QgbXRrX2lvbW11X2RvbWFpbiAqZG9tID0gdG9f
bXRrX2RvbWFpbihkb21haW4pOw0KKwlzdHJ1Y3QgbXRrX2lvbW11X3BndGFibGUgKnBndGFibGUg
PSBtdGtfaW9tbXVfZ2V0X3BndGFibGUoKTsNCiAJc3RydWN0IG10a19pb21tdV9kYXRhICpkYXRh
ID0gbXRrX2lvbW11X2dldF9tNHVfZGF0YSgpOw0KIA0KIAkvKiBUaGUgJnF1b3Q7NEdCIG1vZGUm
cXVvdDsgTTRVIHBoeXNpY2FsbHkgY2FuIG5vdCB1c2UgdGhlIGxvd2VyIHJlbWFwIG9mIERyYW0u
ICovDQpAQCAtNDcxLDE2ICs0NjgsMTYgQEAgc3RhdGljIGludCBtdGtfaW9tbXVfbWFwKHN0cnVj
dCBpb21tdV9kb21haW4gKmRvbWFpbiwgdW5zaWduZWQgbG9uZyBpb3ZhLA0KIAkJcGFkZHIgfD0g
QklUX1VMTCgzMik7DQogDQogCS8qIFN5bmNocm9uaXplIHdpdGggdGhlIHRsYl9sb2NrICovDQot
CXJldHVybiBkb20tJmd0O2lvcC0mZ3Q7bWFwKGRvbS0mZ3Q7aW9wLCBpb3ZhLCBwYWRkciwgc2l6
ZSwgcHJvdCk7DQorCXJldHVybiBwZ3RhYmxlLSZndDtpb3AtJmd0O21hcChwZ3RhYmxlLSZndDtp
b3AsIGlvdmEsIHBhZGRyLCBzaXplLCBwcm90KTsNCiB9DQogDQogc3RhdGljIHNpemVfdCBtdGtf
aW9tbXVfdW5tYXAoc3RydWN0IGlvbW11X2RvbWFpbiAqZG9tYWluLA0KIAkJCSAgICAgIHVuc2ln
bmVkIGxvbmcgaW92YSwgc2l6ZV90IHNpemUsDQogCQkJICAgICAgc3RydWN0IGlvbW11X2lvdGxi
X2dhdGhlciAqZ2F0aGVyKQ0KIHsNCi0Jc3RydWN0IG10a19pb21tdV9kb21haW4gKmRvbSA9IHRv
X210a19kb21haW4oZG9tYWluKTsNCisJc3RydWN0IG10a19pb21tdV9wZ3RhYmxlICpwZ3RhYmxl
ID0gbXRrX2lvbW11X2dldF9wZ3RhYmxlKCk7DQogDQotCXJldHVybiBkb20tJmd0O2lvcC0mZ3Q7
dW5tYXAoZG9tLSZndDtpb3AsIGlvdmEsIHNpemUsIGdhdGhlcik7DQorCXJldHVybiBwZ3RhYmxl
LSZndDtpb3AtJmd0O3VubWFwKHBndGFibGUtJmd0O2lvcCwgaW92YSwgc2l6ZSwgZ2F0aGVyKTsN
CiB9DQogDQogc3RhdGljIHZvaWQgbXRrX2lvbW11X2ZsdXNoX2lvdGxiX2FsbChzdHJ1Y3QgaW9t
bXVfZG9tYWluICpkb21haW4pDQpAQCAtNTA0LDExICs1MDEsMTEgQEAgc3RhdGljIHZvaWQgbXRr
X2lvbW11X2lvdGxiX3N5bmMoc3RydWN0IGlvbW11X2RvbWFpbiAqZG9tYWluLA0KIHN0YXRpYyBw
aHlzX2FkZHJfdCBtdGtfaW9tbXVfaW92YV90b19waHlzKHN0cnVjdCBpb21tdV9kb21haW4gKmRv
bWFpbiwNCiAJCQkJCSAgZG1hX2FkZHJfdCBpb3ZhKQ0KIHsNCi0Jc3RydWN0IG10a19pb21tdV9k
b21haW4gKmRvbSA9IHRvX210a19kb21haW4oZG9tYWluKTsNCisJc3RydWN0IG10a19pb21tdV9w
Z3RhYmxlICpwZ3RhYmxlID0gbXRrX2lvbW11X2dldF9wZ3RhYmxlKCk7DQogCXN0cnVjdCBtdGtf
aW9tbXVfZGF0YSAqZGF0YSA9IG10a19pb21tdV9nZXRfbTR1X2RhdGEoKTsNCiAJcGh5c19hZGRy
X3QgcGE7DQogDQotCXBhID0gZG9tLSZndDtpb3AtJmd0O2lvdmFfdG9fcGh5cyhkb20tJmd0O2lv
cCwgaW92YSk7DQorCXBhID0gcGd0YWJsZS0mZ3Q7aW9wLSZndDtpb3ZhX3RvX3BoeXMocGd0YWJs
ZS0mZ3Q7aW9wLCBpb3ZhKTsNCiAJaWYgKGRhdGEtJmd0O2VuYWJsZV80R0IgJmFtcDsmYW1wOyBw
YSAmZ3Q7PSBNVEtfSU9NTVVfNEdCX01PREVfUkVNQVBfQkFTRSkNCiAJCXBhICZhbXA7PSB+QklU
X1VMTCgzMik7DQogDQpAQCAtODUwLDggKzg0Nyw4IEBAIHN0YXRpYyBpbnQgX19tYXliZV91bnVz
ZWQgbXRrX2lvbW11X3N1c3BlbmQoc3RydWN0IGRldmljZSAqZGV2KQ0KIHN0YXRpYyBpbnQgX19t
YXliZV91bnVzZWQgbXRrX2lvbW11X3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICpkZXYpDQogew0KIAlz
dHJ1Y3QgbXRrX2lvbW11X2RhdGEgKmRhdGEgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsNCisJc3Ry
dWN0IG10a19pb21tdV9wZ3RhYmxlICpwZ3RhYmxlID0gZGF0YS0mZ3Q7cGd0YWJsZTsNCiAJc3Ry
dWN0IG10a19pb21tdV9zdXNwZW5kX3JlZyAqcmVnID0gJmFtcDtkYXRhLSZndDtyZWc7DQotCXN0
cnVjdCBtdGtfaW9tbXVfZG9tYWluICptNHVfZG9tID0gZGF0YS0mZ3Q7bTR1X2RvbTsNCiAJdm9p
ZCBfX2lvbWVtICpiYXNlID0gZGF0YS0mZ3Q7YmFzZTsNCiAJaW50IHJldDsNCiANCkBAIC04Njks
OCArODY2LDggQEAgc3RhdGljIGludCBfX21heWJlX3VudXNlZCBtdGtfaW9tbXVfcmVzdW1lKHN0
cnVjdCBkZXZpY2UgKmRldikNCiAJd3JpdGVsX3JlbGF4ZWQocmVnLSZndDtpbnRfbWFpbl9jb250
cm9sLCBiYXNlICsgUkVHX01NVV9JTlRfTUFJTl9DT05UUk9MKTsNCiAJd3JpdGVsX3JlbGF4ZWQo
cmVnLSZndDtpdnJwX3BhZGRyLCBiYXNlICsgUkVHX01NVV9JVlJQX1BBRERSKTsNCiAJd3JpdGVs
X3JlbGF4ZWQocmVnLSZndDt2bGRfcGFfcm5nLCBiYXNlICsgUkVHX01NVV9WTERfUEFfUk5HKTsN
Ci0JaWYgKG00dV9kb20pDQotCQl3cml0ZWwobTR1X2RvbS0mZ3Q7Y2ZnLmFybV92N3NfY2ZnLnR0
YnJbMF0gJmFtcDsgTU1VX1BUX0FERFJfTUFTSywNCisJaWYgKHBndGFibGUpDQorCQl3cml0ZWwo
cGd0YWJsZS0mZ3Q7Y2ZnLmFybV92N3NfY2ZnLnR0YnJbMF0gJmFtcDsgTU1VX1BUX0FERFJfTUFT
SywNCiAJCSAgICAgICBiYXNlICsgUkVHX01NVV9QVF9CQVNFX0FERFIpOw0KIAlyZXR1cm4gMDsN
CiB9DQotLSANCjIuMTguMA0KDQo8L3ByZT48IS0tdHlwZTp0ZXh0LS0+PCEtLXstLT48cHJlPioq
KioqKioqKioqKiogTUVESUFURUsgQ29uZmlkZW50aWFsaXR5IE5vdGljZQ0KICoqKioqKioqKioq
KioqKioqKioqDQpUaGUgaW5mb3JtYXRpb24gY29udGFpbmVkIGluIHRoaXMgZS1tYWlsIG1lc3Nh
Z2UgKGluY2x1ZGluZyBhbnkgDQphdHRhY2htZW50cykgbWF5IGJlIGNvbmZpZGVudGlhbCwgcHJv
cHJpZXRhcnksIHByaXZpbGVnZWQsIG9yIG90aGVyd2lzZQ0KZXhlbXB0IGZyb20gZGlzY2xvc3Vy
ZSB1bmRlciBhcHBsaWNhYmxlIGxhd3MuIEl0IGlzIGludGVuZGVkIHRvIGJlIA0KY29udmV5ZWQg
b25seSB0byB0aGUgZGVzaWduYXRlZCByZWNpcGllbnQocykuIEFueSB1c2UsIGRpc3NlbWluYXRp
b24sIA0KZGlzdHJpYnV0aW9uLCBwcmludGluZywgcmV0YWluaW5nIG9yIGNvcHlpbmcgb2YgdGhp
cyBlLW1haWwgKGluY2x1ZGluZyBpdHMgDQphdHRhY2htZW50cykgYnkgdW5pbnRlbmRlZCByZWNp
cGllbnQocykgaXMgc3RyaWN0bHkgcHJvaGliaXRlZCBhbmQgbWF5IA0KYmUgdW5sYXdmdWwuIElm
IHlvdSBhcmUgbm90IGFuIGludGVuZGVkIHJlY2lwaWVudCBvZiB0aGlzIGUtbWFpbCwgb3IgYmVs
aWV2ZQ0KIA0KdGhhdCB5b3UgaGF2ZSByZWNlaXZlZCB0aGlzIGUtbWFpbCBpbiBlcnJvciwgcGxl
YXNlIG5vdGlmeSB0aGUgc2VuZGVyIA0KaW1tZWRpYXRlbHkgKGJ5IHJlcGx5aW5nIHRvIHRoaXMg
ZS1tYWlsKSwgZGVsZXRlIGFueSBhbmQgYWxsIGNvcGllcyBvZiANCnRoaXMgZS1tYWlsIChpbmNs
dWRpbmcgYW55IGF0dGFjaG1lbnRzKSBmcm9tIHlvdXIgc3lzdGVtLCBhbmQgZG8gbm90DQpkaXNj
bG9zZSB0aGUgY29udGVudCBvZiB0aGlzIGUtbWFpbCB0byBhbnkgb3RoZXIgcGVyc29uLiBUaGFu
ayB5b3UhDQo8L3ByZT48IS0tfS0tPg==

--__=_Part_Boundary_005_568621771.225270334
Content-Type: text/plain
Content-Transfer-Encoding: base64

VGhpcyBwYXRjaCB3aWxsIHVzZSBtdGtfaW9tbXVfcGd0YWJsZSB0byByZXBsYWNlIHRoZSBwYXJ0
DQpvZiBwZ3RhYmxlIGluIG10a19pb21tdV9kb21haW4sIHNvIHdlIGNhbiByZW1vdmUgdGhlIGlu
Zm9ybWF0aW9uDQpvZiBwZ3RhYmxlIGluIG10a19pb21tdV9kb21haW4uDQoNClNpZ25lZC1vZmYt
Ynk6IENoYW8gSGFvIDxjaGFvLmhhb0BtZWRpYXRlay5jb20+DQotLS0NCiBkcml2ZXJzL2lvbW11
L210a19pb21tdS5jIHwgMzcgKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLQ0K
IDEgZmlsZSBjaGFuZ2VkLCAxNyBpbnNlcnRpb25zKCspLCAyMCBkZWxldGlvbnMoLSkNCg0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvaW9tbXUvbXRrX2lvbW11LmMgYi9kcml2ZXJzL2lvbW11L210a19p
b21tdS5jDQppbmRleCAzZmEwOWIxMmU5ZjkuLmYyNjRmYThjMTZhMCAxMDA2NDQNCi0tLSBhL2Ry
aXZlcnMvaW9tbXUvbXRrX2lvbW11LmMNCisrKyBiL2RyaXZlcnMvaW9tbXUvbXRrX2lvbW11LmMN
CkBAIC0xMTcsOSArMTE3LDYgQEANCiAjZGVmaW5lIE1US19NNFVfVE9fUE9SVChpZCkJCSgoaWQp
ICYgMHgxZikNCiANCiBzdHJ1Y3QgbXRrX2lvbW11X2RvbWFpbiB7DQotCXN0cnVjdCBpb19wZ3Rh
YmxlX2NmZwkJY2ZnOw0KLQlzdHJ1Y3QgaW9fcGd0YWJsZV9vcHMJCSppb3A7DQotDQogCXN0cnVj
dCBpb21tdV9kb21haW4JCWRvbWFpbjsNCiB9Ow0KIA0KQEAgLTM3OSw2ICszNzYsMTAgQEAgc3Rh
dGljIGludCBtdGtfaW9tbXVfYXR0YWNoX3BndGFibGUoc3RydWN0IG10a19pb21tdV9kYXRhICpk
YXRhLA0KIAkvKiBiaW5kaW5nIHRvIHBndGFibGUgKi8NCiAJZGF0YS0+cGd0YWJsZSA9IHBndGFi
bGU7DQogDQorCS8qIHVwZGF0ZSBIVyBzZXR0aW5ncyAqLw0KKwl3cml0ZWwocGd0YWJsZS0+Y2Zn
LmFybV92N3NfY2ZnLnR0YnJbMF0gJiBNTVVfUFRfQUREUl9NQVNLLA0KKwkgICAgICAgZGF0YS0+
YmFzZSArIFJFR19NTVVfUFRfQkFTRV9BRERSKTsNCisNCiAJZGV2X2luZm8oZGF0YS0+ZGV2LCAi
bTR1JWQgYXR0YWNoX3BndGFibGUgZG9uZSFcbiIsIGRhdGEtPm00dV9pZCk7DQogDQogCXJldHVy
biAwOw0KQEAgLTQwNCw4ICs0MDUsNiBAQCBzdGF0aWMgc3RydWN0IGlvbW11X2RvbWFpbiAqbXRr
X2lvbW11X2RvbWFpbl9hbGxvYyh1bnNpZ25lZCB0eXBlKQ0KIAlpZiAoaW9tbXVfZ2V0X2RtYV9j
b29raWUoJmRvbS0+ZG9tYWluKSkNCiAJCWdvdG8gIGZyZWVfZG9tOw0KIA0KLQlkb20tPmNmZyA9
IHBndGFibGUtPmNmZzsNCi0JZG9tLT5pb3AgPSBwZ3RhYmxlLT5pb3A7DQogCS8qIFVwZGF0ZSBv
dXIgc3VwcG9ydCBwYWdlIHNpemVzIGJpdG1hcCAqLw0KIAlkb20tPmRvbWFpbi5wZ3NpemVfYml0
bWFwID0gcGd0YWJsZS0+Y2ZnLnBnc2l6ZV9iaXRtYXA7DQogDQpAQCAtNDIyLDExICs0MjEsMTIg
QEAgc3RhdGljIHN0cnVjdCBpb21tdV9kb21haW4gKm10a19pb21tdV9kb21haW5fYWxsb2ModW5z
aWduZWQgdHlwZSkNCiANCiBzdGF0aWMgdm9pZCBtdGtfaW9tbXVfZG9tYWluX2ZyZWUoc3RydWN0
IGlvbW11X2RvbWFpbiAqZG9tYWluKQ0KIHsNCi0Jc3RydWN0IG10a19pb21tdV9kb21haW4gKmRv
bSA9IHRvX210a19kb21haW4oZG9tYWluKTsNCisJc3RydWN0IG10a19pb21tdV9wZ3RhYmxlICpw
Z3RhYmxlID0gbXRrX2lvbW11X2dldF9wZ3RhYmxlKCk7DQogDQotCWZyZWVfaW9fcGd0YWJsZV9v
cHMoZG9tLT5pb3ApOw0KIAlpb21tdV9wdXRfZG1hX2Nvb2tpZShkb21haW4pOw0KIAlrZnJlZSh0
b19tdGtfZG9tYWluKGRvbWFpbikpOw0KKwlmcmVlX2lvX3BndGFibGVfb3BzKHBndGFibGUtPmlv
cCk7DQorCWtmcmVlKHBndGFibGUpOw0KIH0NCiANCiBzdGF0aWMgaW50IG10a19pb21tdV9hdHRh
Y2hfZGV2aWNlKHN0cnVjdCBpb21tdV9kb21haW4gKmRvbWFpbiwNCkBAIC00MzksMTEgKzQzOSw4
IEBAIHN0YXRpYyBpbnQgbXRrX2lvbW11X2F0dGFjaF9kZXZpY2Uoc3RydWN0IGlvbW11X2RvbWFp
biAqZG9tYWluLA0KIAkJcmV0dXJuIC1FTk9ERVY7DQogDQogCS8qIFVwZGF0ZSB0aGUgcGd0YWJs
ZSBiYXNlIGFkZHJlc3MgcmVnaXN0ZXIgb2YgdGhlIE00VSBIVyAqLw0KLQlpZiAoIWRhdGEtPm00
dV9kb20pIHsNCisJaWYgKCFkYXRhLT5tNHVfZG9tKQ0KIAkJZGF0YS0+bTR1X2RvbSA9IGRvbTsN
Ci0JCXdyaXRlbChkb20tPmNmZy5hcm1fdjdzX2NmZy50dGJyWzBdICYgTU1VX1BUX0FERFJfTUFT
SywNCi0JCSAgICAgICBkYXRhLT5iYXNlICsgUkVHX01NVV9QVF9CQVNFX0FERFIpOw0KLQl9DQog
DQogCW10a19pb21tdV9jb25maWcoZGF0YSwgZGV2LCB0cnVlKTsNCiAJcmV0dXJuIDA7DQpAQCAt
NDYzLDcgKzQ2MCw3IEBAIHN0YXRpYyB2b2lkIG10a19pb21tdV9kZXRhY2hfZGV2aWNlKHN0cnVj
dCBpb21tdV9kb21haW4gKmRvbWFpbiwNCiBzdGF0aWMgaW50IG10a19pb21tdV9tYXAoc3RydWN0
IGlvbW11X2RvbWFpbiAqZG9tYWluLCB1bnNpZ25lZCBsb25nIGlvdmEsDQogCQkJIHBoeXNfYWRk
cl90IHBhZGRyLCBzaXplX3Qgc2l6ZSwgaW50IHByb3QpDQogew0KLQlzdHJ1Y3QgbXRrX2lvbW11
X2RvbWFpbiAqZG9tID0gdG9fbXRrX2RvbWFpbihkb21haW4pOw0KKwlzdHJ1Y3QgbXRrX2lvbW11
X3BndGFibGUgKnBndGFibGUgPSBtdGtfaW9tbXVfZ2V0X3BndGFibGUoKTsNCiAJc3RydWN0IG10
a19pb21tdV9kYXRhICpkYXRhID0gbXRrX2lvbW11X2dldF9tNHVfZGF0YSgpOw0KIA0KIAkvKiBU
aGUgIjRHQiBtb2RlIiBNNFUgcGh5c2ljYWxseSBjYW4gbm90IHVzZSB0aGUgbG93ZXIgcmVtYXAg
b2YgRHJhbS4gKi8NCkBAIC00NzEsMTYgKzQ2OCwxNiBAQCBzdGF0aWMgaW50IG10a19pb21tdV9t
YXAoc3RydWN0IGlvbW11X2RvbWFpbiAqZG9tYWluLCB1bnNpZ25lZCBsb25nIGlvdmEsDQogCQlw
YWRkciB8PSBCSVRfVUxMKDMyKTsNCiANCiAJLyogU3luY2hyb25pemUgd2l0aCB0aGUgdGxiX2xv
Y2sgKi8NCi0JcmV0dXJuIGRvbS0+aW9wLT5tYXAoZG9tLT5pb3AsIGlvdmEsIHBhZGRyLCBzaXpl
LCBwcm90KTsNCisJcmV0dXJuIHBndGFibGUtPmlvcC0+bWFwKHBndGFibGUtPmlvcCwgaW92YSwg
cGFkZHIsIHNpemUsIHByb3QpOw0KIH0NCiANCiBzdGF0aWMgc2l6ZV90IG10a19pb21tdV91bm1h
cChzdHJ1Y3QgaW9tbXVfZG9tYWluICpkb21haW4sDQogCQkJICAgICAgdW5zaWduZWQgbG9uZyBp
b3ZhLCBzaXplX3Qgc2l6ZSwNCiAJCQkgICAgICBzdHJ1Y3QgaW9tbXVfaW90bGJfZ2F0aGVyICpn
YXRoZXIpDQogew0KLQlzdHJ1Y3QgbXRrX2lvbW11X2RvbWFpbiAqZG9tID0gdG9fbXRrX2RvbWFp
bihkb21haW4pOw0KKwlzdHJ1Y3QgbXRrX2lvbW11X3BndGFibGUgKnBndGFibGUgPSBtdGtfaW9t
bXVfZ2V0X3BndGFibGUoKTsNCiANCi0JcmV0dXJuIGRvbS0+aW9wLT51bm1hcChkb20tPmlvcCwg
aW92YSwgc2l6ZSwgZ2F0aGVyKTsNCisJcmV0dXJuIHBndGFibGUtPmlvcC0+dW5tYXAocGd0YWJs
ZS0+aW9wLCBpb3ZhLCBzaXplLCBnYXRoZXIpOw0KIH0NCiANCiBzdGF0aWMgdm9pZCBtdGtfaW9t
bXVfZmx1c2hfaW90bGJfYWxsKHN0cnVjdCBpb21tdV9kb21haW4gKmRvbWFpbikNCkBAIC01MDQs
MTEgKzUwMSwxMSBAQCBzdGF0aWMgdm9pZCBtdGtfaW9tbXVfaW90bGJfc3luYyhzdHJ1Y3QgaW9t
bXVfZG9tYWluICpkb21haW4sDQogc3RhdGljIHBoeXNfYWRkcl90IG10a19pb21tdV9pb3ZhX3Rv
X3BoeXMoc3RydWN0IGlvbW11X2RvbWFpbiAqZG9tYWluLA0KIAkJCQkJICBkbWFfYWRkcl90IGlv
dmEpDQogew0KLQlzdHJ1Y3QgbXRrX2lvbW11X2RvbWFpbiAqZG9tID0gdG9fbXRrX2RvbWFpbihk
b21haW4pOw0KKwlzdHJ1Y3QgbXRrX2lvbW11X3BndGFibGUgKnBndGFibGUgPSBtdGtfaW9tbXVf
Z2V0X3BndGFibGUoKTsNCiAJc3RydWN0IG10a19pb21tdV9kYXRhICpkYXRhID0gbXRrX2lvbW11
X2dldF9tNHVfZGF0YSgpOw0KIAlwaHlzX2FkZHJfdCBwYTsNCiANCi0JcGEgPSBkb20tPmlvcC0+
aW92YV90b19waHlzKGRvbS0+aW9wLCBpb3ZhKTsNCisJcGEgPSBwZ3RhYmxlLT5pb3AtPmlvdmFf
dG9fcGh5cyhwZ3RhYmxlLT5pb3AsIGlvdmEpOw0KIAlpZiAoZGF0YS0+ZW5hYmxlXzRHQiAmJiBw
YSA+PSBNVEtfSU9NTVVfNEdCX01PREVfUkVNQVBfQkFTRSkNCiAJCXBhICY9IH5CSVRfVUxMKDMy
KTsNCiANCkBAIC04NTAsOCArODQ3LDggQEAgc3RhdGljIGludCBfX21heWJlX3VudXNlZCBtdGtf
aW9tbXVfc3VzcGVuZChzdHJ1Y3QgZGV2aWNlICpkZXYpDQogc3RhdGljIGludCBfX21heWJlX3Vu
dXNlZCBtdGtfaW9tbXVfcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikNCiB7DQogCXN0cnVjdCBt
dGtfaW9tbXVfZGF0YSAqZGF0YSA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOw0KKwlzdHJ1Y3QgbXRr
X2lvbW11X3BndGFibGUgKnBndGFibGUgPSBkYXRhLT5wZ3RhYmxlOw0KIAlzdHJ1Y3QgbXRrX2lv
bW11X3N1c3BlbmRfcmVnICpyZWcgPSAmZGF0YS0+cmVnOw0KLQlzdHJ1Y3QgbXRrX2lvbW11X2Rv
bWFpbiAqbTR1X2RvbSA9IGRhdGEtPm00dV9kb207DQogCXZvaWQgX19pb21lbSAqYmFzZSA9IGRh
dGEtPmJhc2U7DQogCWludCByZXQ7DQogDQpAQCAtODY5LDggKzg2Niw4IEBAIHN0YXRpYyBpbnQg
X19tYXliZV91bnVzZWQgbXRrX2lvbW11X3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICpkZXYpDQogCXdy
aXRlbF9yZWxheGVkKHJlZy0+aW50X21haW5fY29udHJvbCwgYmFzZSArIFJFR19NTVVfSU5UX01B
SU5fQ09OVFJPTCk7DQogCXdyaXRlbF9yZWxheGVkKHJlZy0+aXZycF9wYWRkciwgYmFzZSArIFJF
R19NTVVfSVZSUF9QQUREUik7DQogCXdyaXRlbF9yZWxheGVkKHJlZy0+dmxkX3BhX3JuZywgYmFz
ZSArIFJFR19NTVVfVkxEX1BBX1JORyk7DQotCWlmIChtNHVfZG9tKQ0KLQkJd3JpdGVsKG00dV9k
b20tPmNmZy5hcm1fdjdzX2NmZy50dGJyWzBdICYgTU1VX1BUX0FERFJfTUFTSywNCisJaWYgKHBn
dGFibGUpDQorCQl3cml0ZWwocGd0YWJsZS0+Y2ZnLmFybV92N3NfY2ZnLnR0YnJbMF0gJiBNTVVf
UFRfQUREUl9NQVNLLA0KIAkJICAgICAgIGJhc2UgKyBSRUdfTU1VX1BUX0JBU0VfQUREUik7DQog
CXJldHVybiAwOw0KIH0NCi0tIA0KMi4xOC4wDQo=

--__=_Part_Boundary_005_568621771.225270334--


--===============2854122726277219096==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

_______________________________________________
iommu mailing list
iommu@lists.linux-foundation.org
https://lists.linuxfoundation.org/mailman/listinfo/iommu
--===============2854122726277219096==--

